decluttering_templates:
  game_stats:
    card:
      type: custom:auto-entities
      unique: true
      show_empty: false
      card:
        type: custom:layout-card
        layout_type: masonry
        width: 200px
        max-columns: 5
      card_param: cards
      filter:
        template: |
          {%- for team in integration_entities("teamtracker") -%}
            {%- if state_attr(team, "league") == "[[sport]]" -%}
              {%- if states(team) == "[[status]]" -%}
                {%- if state_attr(team, "team_homeaway") == "home" -%}
                  {%- if states('sensor.nfl_red_zone') is defined and team in state_attr('sensor.nfl_red_zone','teams') -%}
                    {{{"type": "custom:teamtracker-card",
                      "entity": team,
                      "card_mod": {"style": "ha-card {\n\n    color:  black; \n    background-color:  #ffcccc; \n    box-shadow: 0 0 10px 5px red;\n}\n"},
                      "home_side": "right"}}},
                  {%- else -%}
                    {{{"type": "custom:teamtracker-card",
                      "entity": team, 
                      "home_side": "right"}}},
                  {%- endif -%}
                {%- endif -%}
              {%- endif -%}
            {%- endif -%}
          {%- endfor -%}
        exclude:
          - entity_id: '*team_tracker*'
      sort:
        method: attribute
        attribute: date
views:
  - title: Home
    cards:
      - type: custom:layout-card
        layout_type: custom:grid-layout
        layout:
          grid-template-columns: repeat(4, 1fr)
          grid-gap: 10px
        cards:
          - type: vertical-stack
            cards:
              - type: custom:teamtracker-card
                entity: sensor.chicago_blackhawks
                outline: true
                outline_color: deeppink
              - type: custom:teamtracker-card
                entity: sensor.kansas_city_chiefs
                outline: true
                outline_color: deeppink
          - type: vertical-stack
            cards:
              - type: markdown
                content: |
                  <h1>NHL Games Live</h1>
              - type: custom:decluttering-card
                template: game_stats
                variables:
                  - sport: NHL
                  - status: IN
          - type: vertical-stack
            cards:
              - type: markdown
                content: |
                  <h1>NHL Games Coming-up</h1>
              - type: custom:decluttering-card
                template: game_stats
                variables:
                  - sport: NHL
                  - status: PRE
          - type: vertical-stack
            cards:
              - type: markdown
                content: |
                  <h1>NHL Games Completed</h1>
              - type: custom:decluttering-card
                template: game_stats
                variables:
                  - sport: NHL
                  - status: POST
        column_span: 4
    header:
      layout: center
      badges_position: top
    type: custom:grid-layout
